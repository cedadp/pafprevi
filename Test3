import pandas as pd

# Charger le fichier Excel dans un DataFrame
df = pd.read_excel('votre_fichier.xlsx')

# Convertir la colonne 'heure' en datetime pour extraire seulement l'heure
df['heure'] = pd.to_datetime(df['heure'], format='%H:%M').dt.time

# Grouper par 'type M' et 'type P' et agréger les heures
grouped = df.groupby(['type M', 'type P'])['heure'].apply(lambda x: ', '.join(x.astype(str))).reset_index()

# Écrire les combinaisons dans un fichier texte
with open('combinations_format.txt', 'w') as f:
    for _, row in grouped.iterrows():
        f.write(f"TM = {row['type M']} & TP = {row['type P']} & heure IN {{{row['heure']}}}\n")

print("Les combinaisons ont été enregistrées dans le fichier 'combinations_format.txt'.")
